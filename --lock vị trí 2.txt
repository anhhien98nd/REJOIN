-- üå∏ Auto TP2 Lock 3 Giai ƒêo·∫°n (Th·ªùi gian m·ªõi)
local Players = game:GetService("Players")
local p = Players.LocalPlayer
local STATE = { tp2 = false }

-- ‚è≥ Ch·ªù character v√† HumanoidRootPart s·∫µn s√†ng
local function waitForHRP()
	local chr = p.Character or p.CharacterAdded:Wait()
	local hrp = chr:FindFirstChild("HumanoidRootPart")
	local waited = 0
	while not hrp and waited < 5 do
		task.wait(0.2)
		waited += 0.2
		chr = p.Character or p.CharacterAdded:Wait()
		hrp = chr:FindFirstChild("HumanoidRootPart")
	end
	return hrp
end

-- üîí H√†m b·∫Øt ƒë·∫ßu lock v·ªã tr√≠
local function startLock(pos)
	if STATE.tp2 then return end
	STATE.tp2 = true
	print("[AUTO] üîí B·∫Øt ƒë·∫ßu lock v·ªã tr√≠ t·∫°i:", tostring(pos))

	local hrp = waitForHRP()
	local look
	if hrp then
		pcall(function()
			look = hrp.CFrame.LookVector
		end)
	end

	task.spawn(function()
		while STATE.tp2 do
			task.wait()
			local c = p.Character
			if c then
				local h = c:FindFirstChild("HumanoidRootPart")
				if h then
					pcall(function()
						h.Velocity = Vector3.new(0, 0, 0)
						if look then
							h.CFrame = CFrame.new(pos, pos + look)
						else
							h.CFrame = CFrame.new(pos)
						end
					end)
				end
			end
		end
	end)
end

-- üîì H√†m d·ª´ng lock
local function stopLock()
	if STATE.tp2 then
		STATE.tp2 = false
		print("[AUTO] üîì D·ª´ng lock v·ªã tr√≠.")
	end
end

-- üïí Chu·ªói 3 giai ƒëo·∫°n th·ªùi gian
task.spawn(function()
	local pos = Vector3.new(42.29, 3.63, -132.49)

	-- üü¢ Giai ƒëo·∫°n 1: 10s ‚Üí 77s
	task.wait(10)
	startLock(pos)
	print("[AUTO] üü¢ Giai ƒëo·∫°n 1 b·∫Øt ƒë·∫ßu (10s ‚Üí 77s)")
	task.wait(67) -- 10 ‚Üí 77
	stopLock()
	print("[AUTO] ‚úÖ K·∫øt th√∫c giai ƒëo·∫°n 1 t·∫°i 77s")

	-- üü° Giai ƒëo·∫°n 2: 87s ‚Üí 153s
	task.wait(10) -- 77 ‚Üí 87
	startLock(pos)
	print("[AUTO] üü° B·∫≠t l·∫°i TP2 Lock (87s ‚Üí 152s)")
	task.wait(65) -- 87 ‚Üí 152
	stopLock()
	print("[AUTO] ‚úÖ T·∫Øt TP2 Lock l·∫ßn 2 t·∫°i gi√¢y 152")

	-- üîµ Giai ƒëo·∫°n 3: 163s ‚Üí 229s
	task.wait(10) -- 152 ‚Üí 162
	startLock(pos)
	print("[AUTO] üîµ B·∫≠t l·∫°i TP2 Lock (162s ‚Üí 229s)")
	task.wait(67) -- 162 ‚Üí 229
	stopLock()
	print("[AUTO] ‚úÖ T·∫Øt TP2 Lock l·∫ßn 3 t·∫°i gi√¢y 229")
end)
